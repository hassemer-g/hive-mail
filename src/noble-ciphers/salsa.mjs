/* esm.sh - @noble/ciphers@2.0.1/salsa */
import{createCipher as M,rotl as r}from"./_arx.mjs";import{poly1305 as I}from"./_poly1305.mjs";import{abytes as W,clean as D,equalBytes as X,getOutput as J,wrapCipher as Y}from"./utils.mjs";function V(y,a,s,e,n,t=20){let c=y[0],f=a[0],x=a[1],o=a[2],h=a[3],g=y[1],m=s[0],b=s[1],d=n,w=0,C=y[2],R=a[4],A=a[5],p=a[6],i=a[7],j=y[3],K=c,U=f,L=x,P=o,S=h,_=g,q=m,v=b,z=d,B=w,E=C,F=R,N=A,O=p,Q=i,T=j;for(let H=0;H<t;H+=2)S^=r(K+N|0,7),z^=r(S+K|0,9),N^=r(z+S|0,13),K^=r(N+z|0,18),B^=r(_+U|0,7),O^=r(B+_|0,9),U^=r(O+B|0,13),_^=r(U+O|0,18),Q^=r(E+q|0,7),L^=r(Q+E|0,9),q^=r(L+Q|0,13),E^=r(q+L|0,18),P^=r(T+F|0,7),v^=r(P+T|0,9),F^=r(v+P|0,13),T^=r(F+v|0,18),U^=r(K+P|0,7),L^=r(U+K|0,9),P^=r(L+U|0,13),K^=r(P+L|0,18),q^=r(_+S|0,7),v^=r(q+_|0,9),S^=r(v+q|0,13),_^=r(S+v|0,18),F^=r(E+B|0,7),z^=r(F+E|0,9),B^=r(z+F|0,13),E^=r(B+z|0,18),N^=r(T+Q|0,7),O^=r(N+T|0,9),Q^=r(O+N|0,13),T^=r(Q+O|0,18);let l=0;e[l++]=c+K|0,e[l++]=f+U|0,e[l++]=x+L|0,e[l++]=o+P|0,e[l++]=h+S|0,e[l++]=g+_|0,e[l++]=m+q|0,e[l++]=b+v|0,e[l++]=d+z|0,e[l++]=w+B|0,e[l++]=C+E|0,e[l++]=R+F|0,e[l++]=A+N|0,e[l++]=p+O|0,e[l++]=i+Q|0,e[l++]=j+T|0}function Z(y,a,s,e){let n=y[0],t=a[0],c=a[1],f=a[2],x=a[3],o=y[1],h=s[0],g=s[1],m=s[2],b=s[3],d=y[2],w=a[4],C=a[5],R=a[6],A=a[7],p=y[3];for(let j=0;j<20;j+=2)x^=r(n+C|0,7),m^=r(x+n|0,9),C^=r(m+x|0,13),n^=r(C+m|0,18),b^=r(o+t|0,7),R^=r(b+o|0,9),t^=r(R+b|0,13),o^=r(t+R|0,18),A^=r(d+h|0,7),c^=r(A+d|0,9),h^=r(c+A|0,13),d^=r(h+c|0,18),f^=r(p+w|0,7),g^=r(f+p|0,9),w^=r(g+f|0,13),p^=r(w+g|0,18),t^=r(n+f|0,7),c^=r(t+n|0,9),f^=r(c+t|0,13),n^=r(f+c|0,18),h^=r(o+x|0,7),g^=r(h+o|0,9),x^=r(g+h|0,13),o^=r(x+g|0,18),w^=r(d+b|0,7),m^=r(w+d|0,9),b^=r(m+w|0,13),d^=r(b+m|0,18),C^=r(p+A|0,7),R^=r(C+p|0,9),A^=r(R+C|0,13),p^=r(A+R|0,18);let i=0;e[i++]=n,e[i++]=o,e[i++]=d,e[i++]=p,e[i++]=h,e[i++]=g,e[i++]=m,e[i++]=b}var e0=M(V,{allowShortKeys:!0,counterRight:!0}),G=M(V,{counterRight:!0,extendNonceFn:Z}),$=Y({blockSize:64,nonceLength:24,tagLength:16},(y,a)=>({encrypt(s,e){e=J(s.length+32,e,!1);let n=e.subarray(0,32),t=e.subarray(32);e.set(s,32),D(n),G(y,a,e,e);let c=I(t,n);return e.set(c,16),D(e.subarray(0,16),c),e.subarray(16)},decrypt(s,e){W(s),e=J(s.length+32,e,!1);let n=e.subarray(0,32),t=e.subarray(32,48),c=e.subarray(48);e.set(s,32),D(n);let f=G(y,a,n,n),x=I(c,f);if(!X(t,x))throw new Error("invalid tag");return G(y,a,e.subarray(16),e.subarray(16)),D(n,t,x),c}}));function a0(y,a){let s=$(y,a);return{seal:s.encrypt,open:s.decrypt}}export{Z as hsalsa,e0 as salsa20,a0 as secretbox,G as xsalsa20,$ as xsalsa20poly1305};
//# sourceMappingURL=salsa.mjs.map
