/* esm.sh - @noble/ciphers@2.0.1/chacha */
import{createCipher as j,createPRG as W,rotl as e}from"./_arx.mjs";import{poly1305 as $}from"./_poly1305.mjs";import{abytes as A,clean as H,equalBytes as D,getOutput as J,u64Lengths as k,wrapCipher as X}from"./utils.mjs";function u(l,a,g,t,h,r=20){let n=l[0],c=l[1],o=l[2],s=l[3],L=a[0],x=a[1],R=a[2],w=a[3],m=a[4],C=a[5],y=a[6],f=a[7],i=h,d=g[0],N=g[1],Q=g[2],U=n,K=c,S=o,_=s,b=L,E=x,O=R,P=w,v=m,z=C,T=y,Z=f,q=i,B=d,F=N,G=Q;for(let I=0;I<r;I+=2)U=U+b|0,q=e(q^U,16),v=v+q|0,b=e(b^v,12),U=U+b|0,q=e(q^U,8),v=v+q|0,b=e(b^v,7),K=K+E|0,B=e(B^K,16),z=z+B|0,E=e(E^z,12),K=K+E|0,B=e(B^K,8),z=z+B|0,E=e(E^z,7),S=S+O|0,F=e(F^S,16),T=T+F|0,O=e(O^T,12),S=S+O|0,F=e(F^S,8),T=T+F|0,O=e(O^T,7),_=_+P|0,G=e(G^_,16),Z=Z+G|0,P=e(P^Z,12),_=_+P|0,G=e(G^_,8),Z=Z+G|0,P=e(P^Z,7),U=U+E|0,G=e(G^U,16),T=T+G|0,E=e(E^T,12),U=U+E|0,G=e(G^U,8),T=T+G|0,E=e(E^T,7),K=K+O|0,q=e(q^K,16),Z=Z+q|0,O=e(O^Z,12),K=K+O|0,q=e(q^K,8),Z=Z+q|0,O=e(O^Z,7),S=S+P|0,B=e(B^S,16),v=v+B|0,P=e(P^v,12),S=S+P|0,B=e(B^S,8),v=v+B|0,P=e(P^v,7),_=_+b|0,F=e(F^_,16),z=z+F|0,b=e(b^z,12),_=_+b|0,F=e(F^_,8),z=z+F|0,b=e(b^z,7);let p=0;t[p++]=n+U|0,t[p++]=c+K|0,t[p++]=o+S|0,t[p++]=s+_|0,t[p++]=L+b|0,t[p++]=x+E|0,t[p++]=R+O|0,t[p++]=w+P|0,t[p++]=m+v|0,t[p++]=C+z|0,t[p++]=y+T|0,t[p++]=f+Z|0,t[p++]=i+q|0,t[p++]=d+B|0,t[p++]=N+F|0,t[p++]=Q+G|0}function e0(l,a,g,t){let h=l[0],r=l[1],n=l[2],c=l[3],o=a[0],s=a[1],L=a[2],x=a[3],R=a[4],w=a[5],m=a[6],C=a[7],y=g[0],f=g[1],i=g[2],d=g[3];for(let Q=0;Q<20;Q+=2)h=h+o|0,y=e(y^h,16),R=R+y|0,o=e(o^R,12),h=h+o|0,y=e(y^h,8),R=R+y|0,o=e(o^R,7),r=r+s|0,f=e(f^r,16),w=w+f|0,s=e(s^w,12),r=r+s|0,f=e(f^r,8),w=w+f|0,s=e(s^w,7),n=n+L|0,i=e(i^n,16),m=m+i|0,L=e(L^m,12),n=n+L|0,i=e(i^n,8),m=m+i|0,L=e(L^m,7),c=c+x|0,d=e(d^c,16),C=C+d|0,x=e(x^C,12),c=c+x|0,d=e(d^c,8),C=C+d|0,x=e(x^C,7),h=h+s|0,d=e(d^h,16),m=m+d|0,s=e(s^m,12),h=h+s|0,d=e(d^h,8),m=m+d|0,s=e(s^m,7),r=r+L|0,y=e(y^r,16),C=C+y|0,L=e(L^C,12),r=r+L|0,y=e(y^r,8),C=C+y|0,L=e(L^C,7),n=n+x|0,f=e(f^n,16),R=R+f|0,x=e(x^R,12),n=n+x|0,f=e(f^n,8),R=R+f|0,x=e(x^R,7),c=c+o|0,i=e(i^c,16),w=w+i|0,o=e(o^w,12),c=c+o|0,i=e(i^c,8),w=w+i|0,o=e(o^w,7);let N=0;t[N++]=h,t[N++]=r,t[N++]=n,t[N++]=c,t[N++]=y,t[N++]=f,t[N++]=i,t[N++]=d}var n0=j(u,{counterRight:!1,counterLength:8,allowShortKeys:!0}),t0=j(u,{counterRight:!1,counterLength:4,allowShortKeys:!1}),a0=j(u,{counterRight:!1,counterLength:8,extendNonceFn:e0,allowShortKeys:!1}),r0=j(u,{counterRight:!1,counterLength:4,rounds:8}),g0=j(u,{counterRight:!1,counterLength:4,rounds:12}),c0=new Uint8Array(16),M=(l,a)=>{l.update(a);let g=a.length%16;g&&l.update(c0.subarray(g))},h0=new Uint8Array(32);function V(l,a,g,t,h){h!==void 0&&A(h,void 0,"AAD");let r=l(a,g,h0),n=k(t.length,h?h.length:0,!0),c=$.create(r);h&&M(c,h),M(c,t),c.update(n);let o=c.digest();return H(r,n),o}var Y=l=>(a,g,t)=>({encrypt(r,n){let c=r.length;n=J(c+16,n,!1),n.set(r);let o=n.subarray(0,-16);l(a,g,o,o,1);let s=V(l,a,g,o,t);return n.set(s,c),H(s),n},decrypt(r,n){n=J(r.length-16,n,!1);let c=r.subarray(0,-16),o=r.subarray(-16),s=V(l,a,g,c,t);if(!D(o,s))throw new Error("invalid tag");return n.set(r.subarray(0,-16)),l(a,g,n,n,1),H(s),n}}),y0=X({blockSize:64,nonceLength:12,tagLength:16},Y(t0)),f0=X({blockSize:64,nonceLength:24,tagLength:16},Y(a0)),i0=W(n0,64,32,8),d0=W(r0,64,32,12);export{Y as _poly1305_aead,g0 as chacha12,t0 as chacha20,n0 as chacha20orig,y0 as chacha20poly1305,r0 as chacha8,e0 as hchacha,i0 as rngChacha20,d0 as rngChacha8,a0 as xchacha20,f0 as xchacha20poly1305};
//# sourceMappingURL=chacha.mjs.map
