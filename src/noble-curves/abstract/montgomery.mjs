/* esm.sh - @noble/curves@2.0.1/abstract/montgomery */
import{abytes as S,aInRange as M,bytesToNumberLE as R,copyBytes as T,numberToBytesLE as rt,randomBytes as it,validateObject as at}from"../utils.mjs";import{createKeygen as ut}from"./curve.mjs";import{mod as dt}from"./modular.mjs";var l=BigInt(0),B=BigInt(1),f=BigInt(2);function Bt(m){return at(m,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...m})}function gt(m){let N=Bt(m),{P:x,type:E,adjustScalarBytes:V,powPminus2:q,randomBytes:F}=N,c=E==="x25519";if(!c&&E!=="x448")throw new Error("invalid type");let H=F||it,J=c?255:448,i=c?32:56,Q=BigInt(c?9:5),W=BigInt(c?121665:39081),j=c?f**BigInt(254):f**BigInt(447),X=c?BigInt(8)*f**BigInt(251)-B:BigInt(4)*f**BigInt(445)-B,Y=j+X+B,n=t=>dt(t,x),v=z(Q);function z(t){return rt(n(t),i)}function Z(t){let e=T(S(t,i,"uCoordinate"));return c&&(e[31]&=127),n(R(e))}function $(t){return R(V(T(S(t,i,"scalar"))))}function p(t,e){let o=nt(Z(e),$(t));if(o===l)throw new Error("invalid private or public key received");return z(o)}function A(t){return p(t,v)}let K=A,tt=p;function y(t,e,o){let g=n(t*(e-o));return e=n(e-g),o=n(o+g),{x_2:e,x_3:o}}function nt(t,e){M("u",t,l,x),M("scalar",e,j,Y);let o=e,g=t,s=B,r=l,a=t,u=B,d=l;for(let I=BigInt(J-1);I>=l;I--){let k=o>>I&B;d^=k,{x_2:s,x_3:a}=y(d,s,a),{x_2:r,x_3:u}=y(d,r,u),d=k;let b=s+r,_=n(b*b),w=s-r,C=n(w*w),L=_-C,ct=a+u,st=a-u,O=n(st*b),G=n(ct*w),U=O+G,D=O-G;a=n(U*U),u=n(g*n(D*D)),s=n(_*C),r=n(L*(_+n(W*L)))}({x_2:s,x_3:a}=y(d,s,a)),{x_2:r,x_3:u}=y(d,r,u);let ot=q(r);return n(s*ot)}let P={secretKey:i,publicKey:i,seed:i},h=(t=H(i))=>(S(t,P.seed,"seed"),t),et={randomSecretKey:h};return Object.freeze({keygen:ut(h,K),getSharedSecret:tt,getPublicKey:K,scalarMult:p,scalarMultBase:A,utils:et,GuBytes:v.slice(),lengths:P})}export{gt as montgomery};
/*! Bundled license information:

@noble/curves/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=montgomery.mjs.map
